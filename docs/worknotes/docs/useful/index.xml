<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Useful code snippets on Ed&#39;s Space - Notes</title>
    <link>/worknotes/docs/useful/</link>
    <description>Recent content in Useful code snippets on Ed&#39;s Space - Notes</description>
    <generator>Hugo</generator>
    <language>en</language>
    <atom:link href="/worknotes/docs/useful/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Direct pair search</title>
      <link>/worknotes/docs/useful/fixed-cutoff-direct-pair-search/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>/worknotes/docs/useful/fixed-cutoff-direct-pair-search/</guid>
      <description>&lt;h1 id=&#34;point-pairs-search-with-fixed-cutoff-distance-direct&#34;&gt;&#xA;  Point-pairs search with fixed cutoff distance (direct)&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#point-pairs-search-with-fixed-cutoff-distance-direct&#34;&gt;#&lt;/a&gt;&#xA;&lt;/h1&gt;&#xA;&lt;h2 id=&#34;description&#34;&gt;&#xA;  Description&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#description&#34;&gt;#&lt;/a&gt;&#xA;&lt;/h2&gt;&#xA;&lt;p&gt;I work with point pair searches through particle-based simulations (mostly SPH and DEM). The algorithm here is the most basic way to perform a pair search. It is O(N2) time, so is not useful for any practical applications.&lt;/p&gt;&#xA;&lt;p&gt;I use it frequently to server as a reference when investigating other ways to search for pairs. It&amp;rsquo;s simple to code, so is harder to introduce conceptual and coding errors.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Cell list pair search</title>
      <link>/worknotes/docs/useful/fixed-cutoff-cell-lists-pair-search/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>/worknotes/docs/useful/fixed-cutoff-cell-lists-pair-search/</guid>
      <description>&lt;h1 id=&#34;point-pairs-search-with-fixed-cutoff-distance-using-cell-lists&#34;&gt;&#xA;  Point-pairs search with fixed cutoff distance (using cell-lists)&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#point-pairs-search-with-fixed-cutoff-distance-using-cell-lists&#34;&gt;#&lt;/a&gt;&#xA;&lt;/h1&gt;&#xA;&lt;h2 id=&#34;description&#34;&gt;&#xA;  Description&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#description&#34;&gt;#&lt;/a&gt;&#xA;&lt;/h2&gt;&#xA;&lt;p&gt;This is an improvement to the &#xA;  &lt;a href=&#34;/worknotes/docs/useful/fixed-cutoff-direct-pair-search/&#34;&gt;direct search&lt;/a&gt; algorithm for searching for pairs of points within a cutoff distance. It uses a grid of cells whose side-length is equal to the specified cutoff distance.&lt;/p&gt;&#xA;&lt;p&gt;This is beneficial to performance since for any given point, all its neighbours are guaranteed to be within its own cell, or in adjacent cells. This means that instead of performing a comparison with all other points, comparisons only need to be made to points in the same or adjacent cells.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Cell list pair search - reducing search space</title>
      <link>/worknotes/docs/useful/fixed-cutoff-cell-lists-pair-searchhalf-search/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>/worknotes/docs/useful/fixed-cutoff-cell-lists-pair-searchhalf-search/</guid>
      <description>&lt;h1 id=&#34;cell-lists-point-pairs-search-with-fixed-cutoff---reducing-search-space&#34;&gt;&#xA;  Cell-lists point-pairs search with fixed cutoff - reducing search space&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#cell-lists-point-pairs-search-with-fixed-cutoff---reducing-search-space&#34;&gt;#&lt;/a&gt;&#xA;&lt;/h1&gt;&#xA;&lt;h2 id=&#34;description&#34;&gt;&#xA;  Description&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#description&#34;&gt;#&lt;/a&gt;&#xA;&lt;/h2&gt;&#xA;&lt;p&gt;&#xA;  &lt;a href=&#34;/worknotes/docs/useful/fixed-cutoff-cell-lists-pair-search/&#34;&gt;The naive cell-list pair search&lt;/a&gt;, is a good&#xA;start. But a drawback of that implementation is that it searches through &lt;em&gt;all&lt;/em&gt; adjacent cells, and uses an &lt;code&gt;if&lt;/code&gt;&#xA;statement to avoid duplicate checks. However, looping over all adjacent cells still takes time, and the &lt;code&gt;if&lt;/code&gt;&#xA;statement can be expensive by introducing branching.&lt;/p&gt;&#xA;&lt;p&gt;However, to eliminate duplicate checks, we only need to compare particles in the current cell with particles&#xA;in half of the adjacent cells. For instance, if you&amp;rsquo;ve checked particle A in one cell against particle B in a&#xA;neighboring cell, you don&amp;rsquo;t need to check B against A again when you move to that neighboring cell. Hence, you&#xA;can omit some cells from the search for each particle to avoid this redundancy. See below sketches that&#xA;illustrate how coverage is not reduced with this strategy.&lt;/p&gt;</description>
    </item>
    <item>
      <title>grid dimension hashing</title>
      <link>/worknotes/docs/useful/grid-rows-spatial-hashing/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>/worknotes/docs/useful/grid-rows-spatial-hashing/</guid>
      <description>&lt;h1 id=&#34;hashing-grid-cell-indices-based-on-grid-dimensions&#34;&gt;&#xA;  Hashing grid cell indices based on grid dimensions&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#hashing-grid-cell-indices-based-on-grid-dimensions&#34;&gt;#&lt;/a&gt;&#xA;&lt;/h1&gt;&#xA;&lt;h2 id=&#34;description&#34;&gt;&#xA;  Description&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#description&#34;&gt;#&lt;/a&gt;&#xA;&lt;/h2&gt;&#xA;&lt;p&gt;This strategy is based on &#xA;  &lt;a href=&#34;https://developer.download.nvidia.com/assets/cuda/files/particles.pdf&#34;&gt;this NVIDIA article&lt;/a&gt;.&#xA;The idea being that instead of storing indices of particles in a grid data structure, you can convert these 3-valued&#xA;indices to single hashes. These hashes can then be used to sort the particle data so that the particle data is ordered&#xA;based on their grid cell hash index. This is beneficial for GPUs, which is why it&amp;rsquo;s mentioned in the above article, but&#xA;is also useful for CPUs as it iterating over the particle pairs more cache-friendly.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Cell lists pair search without &#34;if&#34;</title>
      <link>/worknotes/docs/useful/fixed-cutoff-pair-search-noifs/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>/worknotes/docs/useful/fixed-cutoff-pair-search-noifs/</guid>
      <description>&lt;h1 id=&#34;cell-lists-pair-search-without-if&#34;&gt;&#xA;  Cell lists pair search without &lt;code&gt;if&lt;/code&gt;&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#cell-lists-pair-search-without-if&#34;&gt;#&lt;/a&gt;&#xA;&lt;/h1&gt;&#xA;&lt;h2 id=&#34;description&#34;&gt;&#xA;  Description&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#description&#34;&gt;#&lt;/a&gt;&#xA;&lt;/h2&gt;&#xA;&lt;p&gt;So far, the speedup demonstrated from the &#xA;  &lt;a href=&#34;/worknotes/docs/useful/grid-rows-spatial-hashing/&#34;&gt;fixed-cutoff cell-lists pair search algorithm&lt;/a&gt;&#xA;is pretty great. One last change we can make to improve things, is to remove any &lt;code&gt;if&lt;/code&gt; statements when searching adjacent&#xA;cells. &lt;code&gt;if&lt;/code&gt;&amp;rsquo;s are undesirable because they introduce &#xA;  &lt;a href=&#34;https://en.wikipedia.org/wiki/Branch_%28computer_science%29&#34;&gt;branching&lt;/a&gt;&#xA;and harms performance. I&amp;rsquo;ve found that it can be beneficial to remove &lt;code&gt;if&lt;/code&gt; statements, even if it means a bit more&#xA;computation/assignments are performed.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Z-curve hashing</title>
      <link>/worknotes/docs/useful/z-curve-spatial-hashing/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>/worknotes/docs/useful/z-curve-spatial-hashing/</guid>
      <description>&lt;h1 id=&#34;hashing-grid-cell-indices-based-on-z-order-curve&#34;&gt;&#xA;  Hashing grid cell indices based on Z-order curve&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#hashing-grid-cell-indices-based-on-z-order-curve&#34;&gt;#&lt;/a&gt;&#xA;&lt;/h1&gt;&#xA;&lt;h2 id=&#34;description&#34;&gt;&#xA;  Description&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#description&#34;&gt;#&lt;/a&gt;&#xA;&lt;/h2&gt;&#xA;&lt;h2 id=&#34;code-fortran&#34;&gt;&#xA;  Code (Fortran)&#xA;  &lt;a class=&#34;anchor&#34; href=&#34;#code-fortran&#34;&gt;#&lt;/a&gt;&#xA;&lt;/h2&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-fortran&#34; data-lang=&#34;fortran&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;&lt;span style=&#34;color:#000&#34;&gt;Coming&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;soon&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;...&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
  </channel>
</rss>
