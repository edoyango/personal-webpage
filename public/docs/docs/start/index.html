<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Getting Started # This page will help you get setup and started to run the GraSPH code. And is aimed at beginners. The instruction assume you are working on an Ubuntu machine. a Virtual Machine (VM) or WSL2 will work fine too. This page assumes you are working in a terminal.
Steps are seperated based on which version you wish to run. See the table of contents on the right side of the page.">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark"><meta property="og:title" content="Getting Started" />
<meta property="og:description" content="Getting Started # This page will help you get setup and started to run the GraSPH code. And is aimed at beginners. The instruction assume you are working on an Ubuntu machine. a Virtual Machine (VM) or WSL2 will work fine too. This page assumes you are working in a terminal.
Steps are seperated based on which version you wish to run. See the table of contents on the right side of the page." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/docs/docs/start/" /><meta property="article:section" content="docs" />


<title>Getting Started | GraSPH Docs</title>
<link rel="manifest" href="/docs/manifest.json">
<link rel="icon" href="/docs/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/docs/book.min.16fde4d05cd1cf758f445b62581a359a2b0aa3a8b1be4966bf73546658560a86.css" >
  <script defer src="/docs/flexsearch.min.js"></script>
  <script defer src="/docs/en.search.min.1dc4aeb0ca37d6f601b2ff9faba6ac9a7fb82cb199bd25fed7b7df280f01ad49.js" ></script>

  <script defer src="/docs/sw.min.a126dbd3736712094903d7d2e13a289d1f3f8eddcc1068f145702c048aaa9f61.js" ></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/docs/"><span>GraSPH Docs</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>












  



  
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/start/" class="active">Getting Started</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-e119a32310022f62d4c06c8f517eac24" class="toggle"  />
    <label for="section-e119a32310022f62d4c06c8f517eac24" class="flex justify-between">
      <a role="button" class="">Useful code snippets</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/useful/fixed-cutoff-direct-pair-search/" class="">Direct pair search</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/useful/fixed-cutoff-cell-lists-pair-search/" class="">Cell list pair search</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/useful/grid-rows-spatial-hashing/" class="">grid dimension hashing</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/useful/z-curve-spatial-hashing/" class="">Z-curve hashing</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-c8691a4179c494de8628c8e1b64ba030" class="toggle"  />
    <label for="section-c8691a4179c494de8628c8e1b64ba030" class="flex justify-between">
      <a role="button" class="">CUDA Programming</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/cuda/cuda-wsl/" class="">CUDA &#43; NVHPC on WSL</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/cuda/reference-codes/" class="">nvfortran and nvc&#43;&#43; reference codes</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/cuda/reference-codes/deviceQuery/" class="">deviceQuery</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/cuda/reference-codes/precision_m/" class="">precision_m</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/cuda/reference-codes/error/" class="">Error Handling</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/cuda/reference-codes/limitingFactor/" class="">limitingFactor</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/cuda/reference-codes/peakBandwidth/" class="">peakBandwidth</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/cuda/reference-codes/bandwidthTest/" class="">bandwidthTest</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/cuda/reference-codes/MemCpy/" class="">MemCpy</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/cuda/reference-codes/testAsync/" class="">testAsync</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/cuda/reference-codes/offsetNStride/" class="">offsetNStride</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/cuda/reference-codes/strideTexture/" class="">strideTexture</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/cuda/reference-codes/sharedExample/" class="">sharedExample</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/cuda/reference-codes/checkP2pAccess/" class="">checkP2PAccess</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/cuda/reference-codes/directTransfer/" class="">directTransfer</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/cuda/reference-codes/p2pBandwidth/" class="">p2pBandwidth</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/cuda/reference-codes/mpiDevices/" class="">mpiDevices</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/cuda/reference-codes/mpiDeviceUtil/" class="">mpiDeviceUtil</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/cuda/reference-codes/transposeMPI/" class="">transposeMPI</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-51c3f533883c549c0f1c5f4960205a5e" class="toggle"  />
    <label for="section-51c3f533883c549c0f1c5f4960205a5e" class="flex justify-between">
      <a href="/docs/docs/cfdem/" class="">CFDEM</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/cfdem/snappyhexmesh/" class="">Snappy Hex Mesh Basics</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/cfdem/liggghts-intel-comp/" class="">Speeding Up LIGGGHTS with Intel Compilers and Compiler Options</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-c720b4cbfe3c820847227813f65aa57d" class="toggle"  />
    <label for="section-c720b4cbfe3c820847227813f65aa57d" class="flex justify-between">
      <a role="button" class="">Raspberry Pis</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/pi/trim-jetsonnano/" class="">Reducing Jetson Nano OS for Server</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/pi/webserver/" class="">Setting Up Public Webserver on Raspberry Pi</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docs/pi/slurm-cluster/" class="">Setting Up Raspberry Pi Slurm Cluster</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>











  
<ul>
  
  <li>
    <a href="https://github.com/edoyango/GraSPH"  target="_blank" rel="noopener">
        GraSPH GitHub
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/docs/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Getting Started</strong>

  <label for="toc-control">
    
    <img src="/docs/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#getting-started">Getting Started</a>
      <ul>
        <li><a href="#getting-the-grasph-code">Getting the GraSPH code</a></li>
        <li><a href="#for-running-in-serial">For running in serial</a>
          <ul>
            <li><a href="#prerequisites">Prerequisites</a></li>
            <li><a href="#setting-up-compilation-environment">Setting up compilation environment</a></li>
            <li><a href="#running-the-grasph-code">Running the GraSPH code</a></li>
          </ul>
        </li>
        <li><a href="#for-running-on-multiple-cpus">For running on multiple CPUs</a>
          <ul>
            <li><a href="#prerequisites-1">Prerequisites</a></li>
            <li><a href="#setting-up-the-compilation-environment">Setting up the compilation environment</a></li>
            <li><a href="#running-the-grasph-code-1">Running the GraSPH code</a></li>
          </ul>
        </li>
        <li><a href="#for-running-with-gpus">For running with GPUs</a>
          <ul>
            <li><a href="#prerequisites-2">Prerequisites</a></li>
            <li><a href="#setting-up-the-compilation-environment-1">Setting up the compilation environment</a></li>
            <li><a href="#running-the-grasph-code-2">Running the GraSPH code</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="getting-started">
  Getting Started
  <a class="anchor" href="#getting-started">#</a>
</h1>
<p>This page will help you get setup and started to run the GraSPH code. And is aimed at beginners. The instruction assume you are working on an Ubuntu machine. a Virtual Machine (VM) or WSL2 will work fine too. This page assumes you are working in a terminal.</p>
<p>Steps are seperated based on which version you wish to run. See the table of contents on the right side of the page.</p>
<h2 id="getting-the-grasph-code">
  Getting the GraSPH code
  <a class="anchor" href="#getting-the-grasph-code">#</a>
</h2>
<p>Clone the GraSPH repo with</p>
<pre tabindex="0"><code>git clone https://github.com/edoyango/GraSPH.git
</code></pre><h2 id="for-running-in-serial">
  For running in serial
  <a class="anchor" href="#for-running-in-serial">#</a>
</h2>
<h3 id="prerequisites">
  Prerequisites
  <a class="anchor" href="#prerequisites">#</a>
</h3>
<p>To run the serial version of the code, all you need is a working Fortran compiler, and HDF5. A good compiler to start with is <code>gfortran</code>.</p>
<pre tabindex="0"><code>sudo apt-get install gfortran libhdf5-dev
</code></pre><h3 id="setting-up-compilation-environment">
  Setting up compilation environment
  <a class="anchor" href="#setting-up-compilation-environment">#</a>
</h3>
<pre tabindex="0"><code>export FCFLAGS=-I/usr/include/hdf5/serial
export LDFLAGS=-L/usr/lib/x86_64-linux-gnu/hdf5/serial/libhdf5
export LD_LIBRARY_PATH=/usr/lib/x86_64-linux-gnu/hdf5/serial:$LD_LIBRARY_PATH
export FC=gfortran
</code></pre><h3 id="running-the-grasph-code">
  Running the GraSPH code
  <a class="anchor" href="#running-the-grasph-code">#</a>
</h3>
<pre tabindex="0"><code>cd GraSPH
make mode=serial -f makefiles/Makefile.caf
./sph 10000 1000 1000
</code></pre><h2 id="for-running-on-multiple-cpus">
  For running on multiple CPUs
  <a class="anchor" href="#for-running-on-multiple-cpus">#</a>
</h2>
<h3 id="prerequisites-1">
  Prerequisites
  <a class="anchor" href="#prerequisites-1">#</a>
</h3>
<p>If you wish to run GraSPH in parallel with CPUs, you will need an MPI implementation, the HDF5 MPI libraries, as well as the OpenCoarrays library. All of these are available via APT. However, YUM/DNF does not have the OpenCoarrays library. Below commands use the OpenMPI implementation, but others should work fine too.</p>
<pre tabindex="0"><code>sudo apt-get install openmpi-bin libopenmpi-dev libhdf5-dev libhdf5-openmpi-dev libcoarrays-openmpi-dev
</code></pre><h3 id="setting-up-the-compilation-environment">
  Setting up the compilation environment
  <a class="anchor" href="#setting-up-the-compilation-environment">#</a>
</h3>
<pre tabindex="0"><code>export FCFLAGS=&#34;-I/usr/include/hdf5/openmpi -I/usr/lib/x86_64-linux-gnu/fortran/gfortran-mod-15&#34;
export LDFLAGS=&#34;-L/usr/lib/x86_64-linux-gnu/hdf5/openmpi/libhdf5 /usr/lib/x86_64-linux-gnu/open-coarrays/openmpi/lib/libcaf_mpi.a&#34;
export LD_LIBRARY_PATH=/usr/lib/x86_64-linux-gnu/hdf5/openmpi:$LD_LIBRARY_PATH
export FC=mpifort
</code></pre><h3 id="running-the-grasph-code-1">
  Running the GraSPH code
  <a class="anchor" href="#running-the-grasph-code-1">#</a>
</h3>
<pre tabindex="0"><code>cd GraSPH
make mode=caf -f makefiles/Makefile.caf
mpiexec -n &lt;ncpus&gt; sph 10000 1000 1000
</code></pre><h2 id="for-running-with-gpus">
  For running with GPUs
  <a class="anchor" href="#for-running-with-gpus">#</a>
</h2>
<h3 id="prerequisites-2">
  Prerequisites
  <a class="anchor" href="#prerequisites-2">#</a>
</h3>
<h4 id="cuda-drivers-and-toolkit">
  CUDA drivers and toolkit
  <a class="anchor" href="#cuda-drivers-and-toolkit">#</a>
</h4>
<p>You will need to install the CUDA drivers and toolkit. To get the installer, follow the instructions on the 
  <a href="https://developer.nvidia.com/cuda-downloads">NVIDIA website</a>.</p>
<h4 id="compiler">
  Compiler
  <a class="anchor" href="#compiler">#</a>
</h4>
<p>To run Fortran code on CUDA GPUs, you will have to use <code>nvfortran</code>, NVIDIA&rsquo;s Fortran compiler available through the 
  <a href="https://developer.nvidia.com/hpc-sdk">NVIDIA HPC SDK</a>. You will then have to use this compiler to build the HDF5 libraries.</p>
<h4 id="build-hdf5-with-nvhpc-via-spack">
  Build HDF5 with NVHPC via Spack
  <a class="anchor" href="#build-hdf5-with-nvhpc-via-spack">#</a>
</h4>
<p>Spack is my preferred tool to help automate building software. To get Spack:</p>
<pre tabindex="0"><code>git clone https://github.com/spack/spack.git
</code></pre><p>which clones the repo into the <code>spack</code> directory in the current working directory. Once cloned, setup the environment with</p>
<pre tabindex="0"><code>source spack/share/spack/setup-env.sh
</code></pre><p>You can then add the <code>nvhpc</code> compilers to Spack with</p>
<pre tabindex="0"><code>spack compiler add /opt/nvidia/hpc_sdk/Linux_x86_64/&lt;version&gt;/compilers
</code></pre><p>For example,</p>
<pre tabindex="0"><code>$ spack compiler add /opt/nvidia/hpc_sdk/Linux_x86_64/23.1/compilers
==&gt; Added 1 new compiler to /home/edwardy/.spack/linux/compilers.yaml
    nvhpc@23.1
==&gt; Compilers are defined in the following files:
    /home/edwardy/.spack/linux/compilers.yaml
</code></pre><p>You can then build hdf5 with the command</p>
<pre tabindex="0"><code>spack install hdf5+fortran%nvhpc
</code></pre><p>which is saying &ldquo;build the <code>hdf5</code> package with Fortran libraries using the <code>nvhpc</code> compilers.</p>
<h3 id="setting-up-the-compilation-environment-1">
  Setting up the compilation environment
  <a class="anchor" href="#setting-up-the-compilation-environment-1">#</a>
</h3>
<pre tabindex="0"><code>export HDF5_ROOT=`spack location -i hdf5%nvhpc`
export FCFLAGS=-I$HDF5_ROOT/include
export LDFLAGS=-L$HDF5_ROOT/lib
export LD_LIBRARY_PATH=$HDF5_ROOT/lib:$LD_LIBRARY_PATH
export FC=nvfortran
</code></pre><h3 id="running-the-grasph-code-2">
  Running the GraSPH code
  <a class="anchor" href="#running-the-grasph-code-2">#</a>
</h3>
<pre tabindex="0"><code>cd GraSPH
make -f makefiles/Makefile.cuda
./sph 10000 1000 1000
</code></pre></article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">




  <div>
    <a class="flex align-center" href="https://github.com/edoyango/personal-webpage/edit/main/worknotes/content.en/docs/start.md" target="_blank" rel="noopener">
      <img src="/docs/svg/edit.svg" class="book-icon" alt="Edit" />
      <span>Edit this page</span>
    </a>
  </div>


</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#getting-started">Getting Started</a>
      <ul>
        <li><a href="#getting-the-grasph-code">Getting the GraSPH code</a></li>
        <li><a href="#for-running-in-serial">For running in serial</a>
          <ul>
            <li><a href="#prerequisites">Prerequisites</a></li>
            <li><a href="#setting-up-compilation-environment">Setting up compilation environment</a></li>
            <li><a href="#running-the-grasph-code">Running the GraSPH code</a></li>
          </ul>
        </li>
        <li><a href="#for-running-on-multiple-cpus">For running on multiple CPUs</a>
          <ul>
            <li><a href="#prerequisites-1">Prerequisites</a></li>
            <li><a href="#setting-up-the-compilation-environment">Setting up the compilation environment</a></li>
            <li><a href="#running-the-grasph-code-1">Running the GraSPH code</a></li>
          </ul>
        </li>
        <li><a href="#for-running-with-gpus">For running with GPUs</a>
          <ul>
            <li><a href="#prerequisites-2">Prerequisites</a></li>
            <li><a href="#setting-up-the-compilation-environment-1">Setting up the compilation environment</a></li>
            <li><a href="#running-the-grasph-code-2">Running the GraSPH code</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












